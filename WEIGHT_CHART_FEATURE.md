# 体重趋势图表功能

## 功能概述

新增的体重趋势图表功能为用户提供了直观的体重数据可视化，帮助用户更好地了解体重变化趋势。

## 主要特性

### 1. 图表展示
- **自定义图表组件**: 使用ArkUI的Path、Line、Circle等组件构建轻量级图表
- **体重曲线**: 蓝色实线显示体重变化趋势
- **目标线**: 红色虚线显示目标体重
- **数据点**: 可点击的蓝色圆点显示具体记录

### 2. 时间范围选择
- **一周**: 显示最近7天的数据
- **一月**: 显示最近30天的数据  
- **三月**: 显示最近90天的数据
- **动态切换**: 实时更新图表数据

### 3. 统计信息
- **当前体重**: 最新记录的体重
- **总体变化**: 从开始到现在的体重变化
- **平均体重**: 时间范围内的平均体重
- **体重范围**: 最高体重与最低体重的差值

### 4. 交互功能
- **点击数据点**: 显示详细信息（日期、体重、与目标的差距）
- **目标体重设置**: 点击图例中的目标线可设置新的目标体重
- **平滑动画**: 数据切换时的过渡效果

### 5. 数据管理
- **日期范围查询**: 新增`queryByDateRange()`方法
- **最近记录查询**: 新增`queryRecentRecords()`方法
- **目标体重管理**: 在WeightRecord模型中实现

## 技术实现

### 文件结构
```
entry/src/main/ets/
├── model/
│   └── WeightRecord.ets          # 扩展目标体重管理
├── data/
│   └── WeightRecordDao.ets       # 新增日期范围查询方法
└── pages/
    ├── Index.ets                 # 添加"趋势图表"按钮
    ├── History.ets               # 添加图表入口
    └── WeightChart.ets           # 新的图表页面
```

### 核心组件
- **WeightChartPage**: 主图表页面组件
- **StatisticsCard**: 统计信息卡片
- **GridBackground**: 图表背景网格
- **AxisLabels**: Y轴标签

### 数据流程
1. 页面加载时调用`loadChartData()`
2. 根据时间范围查询数据库记录
3. 数据处理和坐标转换
4. 图表渲染和交互响应

## 导航更新

### 主要入口
- **首页**: 新增"趋势图表"按钮
- **历史页**: 右上角添加图表入口图标

### 页面配置
更新了`main_pages.json`，新增`pages/WeightChart`路由。

## 使用方法

1. **访问图表**: 从首页点击"趋势图表"或从历史页点击右上角图标
2. **选择时间范围**: 使用顶部的周/月/三月按钮
3. **查看详情**: 点击图表上的数据点
4. **设置目标**: 点击图例中的目标体重设置
5. **查看统计**: 图表上方显示关键统计信息

## 设计规范

- **配色方案**: 
  - 主题色: #007DFF (蓝色)
  - 目标线: 红色虚线
  - 背景色: #F1F3F5 (浅灰)
  - 卡片背景: 白色
- **字体大小**: 
  - 标题: 24px
  - 正文: 14-16px
  - 辅助文字: 12px
- **间距**: 统一使用10px递增系统
- **圆角**: 卡片10px，按钮25px

## 性能优化

- **数据缓存**: 避免重复查询数据库
- **按需渲染**: 只渲染可见的数据点
- **轻量级组件**: 使用原生ArkUI组件而非第三方库

## 扩展性

- **模块化设计**: 各功能组件独立，便于维护
- **配置化**: 时间范围、图表尺寸等可配置
- **数据接口**: 支持更多数据维度的扩展

## 兼容性

- **HarmonyOS**: 兼容ArkTS语法规范
- **设备适配**: 响应式设计支持不同屏幕尺寸
- **版本兼容**: 基于现有架构，无破坏性更改

## 测试建议

1. **功能测试**: 验证图表数据准确性
2. **交互测试**: 测试点击、切换等交互
3. **边界测试**: 测试无数据、大量数据等情况
4. **性能测试**: 验证大数据量下的渲染性能